<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Evaluation of Irish Rules model</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = false;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">PLB DSS Analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa fa fa-home"></span>
     
    About
  </a>
</li>
<li>
  <a href="data.html">
    <span class="fa fa fa fa-table"></span>
     
    Data
  </a>
</li>
<li>
  <a href="Analysis.html">
    <span class="fa fa fa fa-table"></span>
     
    Analysis
  </a>
</li>
<li>
  <a href="Results1.html">
    <span class="fa fa fa fa-table"></span>
     
    Results
  </a>
</li>
<li>
  <a href="FungicideTreatments.html">
    <span class="fa fa fa fa-table"></span>
     
    Usefulness
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mladencucak/AnalysisPLBIreland">
    <span class="fa fa-github-square"></span>
     
    source
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Evaluation of Irish Rules model</h1>

</div>


<div id="libraries" class="section level1">
<h1>Libraries</h1>
<p>Packages needed for the analysis are loaded. If the libraries do not exist locally, they will be downloaded.</p>
<pre class="r"><code>list.of.packages &lt;-
  c(
    &quot;tidyverse&quot;,
    &quot;readxl&quot;,
    &quot;data.table&quot;,
    &quot;lubridate&quot;,
    &quot;knitr&quot;,
    &quot;padr&quot;,
    &quot;readr&quot;,
    &quot;devtools&quot;,
    &quot;pracma&quot;,
    &quot;remotes&quot;,
    &quot;parallel&quot;,
    &quot;pbapply&quot;,
    &quot;ggrepel&quot;,
    &quot;ggthemes&quot;,
    &quot;egg&quot;,
    &quot;rsm&quot;,
    &quot;GGally&quot;,
    &quot;R.utils&quot;,
    &quot;rcompanion&quot;,
    &quot;mgsub&quot;,
    &quot;here&quot;,
    &quot;stringr&quot;,
    &quot;pander&quot;
  )

new.packages &lt;-
  list.of.packages[!(list.of.packages %in% installed.packages()[, &quot;Package&quot;])]

#Download packages that are not already present
if (length(new.packages))
  install.packages(new.packages)

if (&quot;gt&quot; %in% installed.packages() == FALSE)
  remotes::install_github(&quot;rstudio/gt&quot;)

list.of.packages &lt;- c(list.of.packages, &quot;gt&quot;)
packages_load &lt;-
  lapply(list.of.packages, require, character.only = TRUE)

#Print warning if there is a problem with installing/loading some of packages
if (any(as.numeric(packages_load) == 0)) {
  warning(paste(&quot;Package/s&quot;, paste(list.of.packages[packages_load != TRUE]), &quot;not loaded!&quot;))
} else {
  print(&quot;All packages were successfully loaded.&quot;)
}</code></pre>
<pre><code>## [1] &quot;All packages were successfully loaded.&quot;</code></pre>
<pre class="r"><code>rm(list.of.packages, new.packages, packages_load)</code></pre>
</div>
<div id="the-rationale" class="section level1">
<h1>The Rationale</h1>
<p>The crop risk prediction model is useful only if it provides same level of protection as the standard practice, while reducing necessary costs and labor. It was evident that the Irish Rules with their default variable thresholds were to conservative and failed to prove as sustainable solution for the disease forecasting.<br />
Two alternative model parametrisations are proposed and in this section we will implement a theoretical study to evaluate the usefulness with regard to their their potential to save fungicide applications. The performance is evaluated in two ways, as a reduction of: 1. Number of treatments: + With minimum window of 5 days between treatments + With minimum of 5 and maximum of 10 days between treatments 2. Dose reduction based on 7 day calendar treatment</p>
</div>
<div id="cut-off-dates" class="section level1">
<h1>Cut-off Dates</h1>
<p>Soil temperature data.</p>
<pre class="r"><code>soildf&lt;- read_csv(here::here(&quot;tmp&quot;, &quot;agridata_375.csv&quot;),col_types = cols(X1 = col_skip(), X10 = col_skip()), 
    skip = 7)
soildf$date = as.Date(soildf$date,format=&quot;%d-%b-%Y&quot;,  tz = &quot;UTC&quot;)
soildf &lt;- tidyr::separate(soildf, &quot;date&quot;, c(&quot;year_var&quot;, &quot;month&quot;, &quot;day&quot;), sep = &quot;-&quot;, remove = F )
soildf$doy &lt;-  yday(soildf$date)
soildf[,2:5] &lt;- lapply(soildf[,2:5], as.numeric)</code></pre>
<p>We assume that the planting starts day after the daily average soil temperature becomes higher than 8°C for three consecutive days in the beginning of April. This is common practice in Ireland, recommended by Teagasc.</p>
<pre class="r"><code>soildf &lt;- soildf[with(soildf, month &gt;= 4),]
dfls &lt;- base::split(soildf, soildf$year_var)
dates_cut &lt;- 
lapply(dfls, function(x) {
  criteria &lt;- as.numeric(x$soil&gt;8)
  #cumulative sum days matching the criteria
  criteria_sum &lt;- stats::ave(criteria, cumsum(criteria == 0), FUN = cumsum)
  pl_date &lt;- x[match(3, criteria_sum)+1, &quot;date&quot;]
  data.frame( &quot;year&quot; = unique(year(x$date)),
              date = pl_date[1,1])
  
}
) %&gt;% bind_rows() %&gt;% 
rename( &quot;plant_date&quot;  = date)
rm(soildf, dfls)</code></pre>
<p>The data for 2007 is missing so we shall use the mean date from other years.</p>
<pre class="r"><code>dates_cut$plant_doy &lt;-yday(dates_cut$plant_date)
dates_cut &lt;- 
bind_rows(
  list(
    dates_cut,
    data.frame(
      year = 2007,
      plant_date = as.Date(strptime(paste(&quot;2007&quot;, mean(dates_cut$plant_doy, na.rm = T )), format=&quot;%Y %j&quot;)),
      plant_doy = mean(dates_cut$plant_doy)
    )
  )
)</code></pre>
<p>We will assume that the full emergence takes 3 and additional minimum of 2 weeks for full emergence and for the first plants to start meeting in the rows.</p>
<pre class="r"><code>meet_in_rows &lt;- 5*7
dates_cut$prot_start &lt;- with(dates_cut, plant_doy + meet_in_rows)
dates_cut$prot_start &lt;- paste(dates_cut$year, dates_cut$prot_start, sep = &quot;-&quot;) %&gt;% strptime(format=&quot;%Y-%j&quot;) %&gt;% as.Date()</code></pre>
<p>For the purposes of this study we will assume that the growing season lasts 120 days. However, the pesticide protection lasts for at least another three weeks to allow the tuber growth.</p>
<pre class="r"><code>duration_of_season &lt;- 120 + 21 
dates_cut$season_end &lt;- with(dates_cut, plant_doy + duration_of_season)
dates_cut$season_end &lt;- paste(dates_cut$year, dates_cut$season_end, sep = &quot;-&quot;) %&gt;% strptime(format=&quot;%Y-%j&quot;) %&gt;% as.Date()
dates_cut %&gt;% kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">year</th>
<th align="left">plant_date</th>
<th align="right">plant_doy</th>
<th align="left">prot_start</th>
<th align="left">season_end</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2008</td>
<td align="left">2008-04-04</td>
<td align="right">95.00000</td>
<td align="left">2008-05-09</td>
<td align="left">2008-08-23</td>
</tr>
<tr class="even">
<td align="right">2009</td>
<td align="left">2009-04-04</td>
<td align="right">94.00000</td>
<td align="left">2009-05-09</td>
<td align="left">2009-08-23</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="left">2010-04-08</td>
<td align="right">98.00000</td>
<td align="left">2010-05-13</td>
<td align="left">2010-08-27</td>
</tr>
<tr class="even">
<td align="right">2011</td>
<td align="left">2011-04-04</td>
<td align="right">94.00000</td>
<td align="left">2011-05-09</td>
<td align="left">2011-08-23</td>
</tr>
<tr class="odd">
<td align="right">2012</td>
<td align="left">2012-04-04</td>
<td align="right">95.00000</td>
<td align="left">2012-05-09</td>
<td align="left">2012-08-23</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="left">2013-04-12</td>
<td align="right">102.00000</td>
<td align="left">2013-05-17</td>
<td align="left">2013-08-31</td>
</tr>
<tr class="odd">
<td align="right">2014</td>
<td align="left">2014-04-04</td>
<td align="right">94.00000</td>
<td align="left">2014-05-09</td>
<td align="left">2014-08-23</td>
</tr>
<tr class="even">
<td align="right">2015</td>
<td align="left">2015-04-05</td>
<td align="right">95.00000</td>
<td align="left">2015-05-10</td>
<td align="left">2015-08-24</td>
</tr>
<tr class="odd">
<td align="right">2016</td>
<td align="left">2016-04-07</td>
<td align="right">98.00000</td>
<td align="left">2016-05-12</td>
<td align="left">2016-08-26</td>
</tr>
<tr class="even">
<td align="right">2007</td>
<td align="left">2007-04-06</td>
<td align="right">96.11111</td>
<td align="left">2007-05-11</td>
<td align="left">2007-08-25</td>
</tr>
</tbody>
</table>
<p>Load the weather data with model outputs.</p>
<pre class="r"><code>load(file = here::here(&quot;data&quot;, &quot;op_2007_16&quot;, &quot;OP_for_analysis.RData&quot;))

years &lt;-  unique(OP$year_var)

df &lt;- filter(OP, month&gt;=2 &amp; month &lt;=9 );rm(OP)
df &lt;-
  df[, c(&quot;date&quot;,
              &quot;year_var&quot;,
              &quot;short_date&quot;,
              &quot;week_var&quot;,
              &quot;doy&quot;,
              &quot;rain&quot;,
              &quot;temp&quot;,
              &quot;rhum&quot;,
              &quot;90_10_12_rain_ebh&quot;,
              &quot;88_12_10_rainrh_ebh&quot;,
              &quot;88_10_10_rainrh_ebh&quot;)]  #Keep only  columns needed for faster code execution
df &lt;-  dplyr::rename(df, 
             ir = &quot;90_10_12_rain_ebh&quot;,
            ir_opt = &quot;88_12_10_rainrh_ebh&quot;,
            ir_low_risk =  &quot;88_10_10_rainrh_ebh&quot;
       )</code></pre>
</div>
<div id="treatment-frequency-model-vs.calendar" class="section level1">
<h1>Treatment Frequency: Model vs. Calendar</h1>
<p>Calculate the number of calendar treatments, assuming they would start 5 weeks and end 141 days after the planting</p>
<pre class="r"><code>(calendar_five &lt;- round( c(duration_of_season-5*7)/5,0))</code></pre>
<pre><code>## [1] 21</code></pre>
<pre class="r"><code>(calendar_seven &lt;- round( c(duration_of_season-5*7)/7,0))</code></pre>
<pre><code>## [1] 15</code></pre>
<p>We are assuming that a fungicide treatment is activated every time the warning threshold is reached. Minimum period until the next treatment is 5 days. Cumulative sum of recommended treatments is calculated per season.</p>
<pre class="r"><code>ControlFreqFun &lt;-
  function(y,
           weather_data,
           dates_cut,
           min_prot_dur = NULL,
           max_prot_dur = NULL) {
    #Set the warning threshold and run the rest of the script
    warning_threshold &lt;- y
    #Weather and model output data
    fun_df &lt;- weather_data
    
    #Each warning would cause treatment that will keep the plants protected for a period of time
    min_prot_dur &lt;-
      ifelse(is.null(min_prot_dur), 5, min_prot_dur)#If not defined default value is 5 days
    max_prot_dur &lt;-
      ifelse(is.null(max_prot_dur), 10, max_prot_dur)#If not defined default value is 10 days
    
    
    #A function to subset the data for the period of interest in each year
    test.overlap = function(vals, start_date, end_date) {
      rowSums(mapply(function(a, b)
        between(vals, a, b),
        start_date, end_date)) &gt; 0
    }
    
    #Subset the of the data for the duration of &#39;protection&#39; period for each year
     trt_df &lt;-
      fun_df  %&gt;%
      filter(test.overlap(short_date, 
                          dates_cut$prot_start, 
                          dates_cut$season_end + max_prot_dur #Additional days for risk estimation and timing of treatments
                          )
      ) %&gt;%
      dplyr::select(
        ends_with(&quot;year_var&quot;),
        ends_with(&quot;week_var&quot;),
        ends_with(&quot;doy&quot;),
        starts_with(&quot;ir&quot;)
      ) %&gt;%
      group_by(year_var) %&gt;%
      #if there was an accumulation from previous day, it would triger a warning
      #Check all of the first five rows because of possible break of 5 hours
      mutate_at(., .vars = colnames(.[grep(&quot;ir&quot;, colnames(.))]),
                funs(
                  ifelse(row_number() &lt;= 5 &amp; . &gt;= warning_threshold,
                         warning_threshold, .)
                )) %&gt;%
      #all five values all changed so we have to delete 4 of them and leave only 1
      mutate_at(., .vars = colnames(.[grep(&quot;ir&quot;, colnames(.))]),
                funs(ifelse(
                  row_number() &lt;= 4 &amp; . == warning_threshold, 0, .
                ))) %&gt;%
      # Change values coresponding to the warning threshold to 1 for calculating the sum
      mutate_at(., .vars = colnames(.[grep(&quot;ir&quot;, colnames(.))]),
                funs(ifelse(. == warning_threshold, 1, 0))) %&gt;%
      group_by(year_var, week_var, doy) %&gt;%
      summarise_at(., .vars = colnames(.[grep(&quot;ir&quot;, colnames(.))]), .funs = sum)
     
    
     #####################################################################
     #Calculate the number of treatments with with minimum protection duration of 5 days
     TreatmentWindowOne &lt;- function(model_output, min_prot_dur ,max_prot_dur ) {
       # model_output &lt;- trt_df_one[[1]]$ir
       
       y &lt;- model_output
       
       for (i in seq_along( 1: c(length(y) - max_prot_dur))) {
         
         #Following treatment will be implemented on day 5 if there is 1 in the next five days
         if (y[i] == 1 &amp; sum(y[c(i+1):c(i+min_prot_dur)])&gt;0 ) {
           y[i+min_prot_dur] &lt;- 1
           y[c(i+1):c(i+ c(min_prot_dur-1))] &lt;- 0
         }
       }
       #Add zeros for the duration of added period
       y[c(length(y) - max_prot_dur) : length(y)] &lt;- 0
       y
     }
     
     #Apply function on yearly subsets
     trt_df_one &lt;- 
       split(trt_df, trt_df$year_var)
     
     for (year in seq_along(trt_df_one)) {
       x &lt;- trt_df_one[[year]]
       trt_df_one[[year]] &lt;- 
         
         lapply(x[grep(&quot;ir&quot;, colnames(x))], function(x)
           TreatmentWindowOne(x, min_prot_dur ,max_prot_dur)) %&gt;%
         bind_cols()
     }
     
     trt_df_one &lt;-  bind_rows(trt_df_one)
     trt_df_one &lt;-  bind_cols(trt_df[&quot;year_var&quot;],trt_df_one )
     
    #####################################################################
    #Calculate the number of treatments with 5-10 day sliding treatment interval
    TreatmentWindow &lt;- function(model_output, min_prot_dur ,max_prot_dur ) {
      
      
      x &lt;- model_output
      #attach vector, 10 days of 0
      y &lt;- vector(mode = &quot;numeric&quot;, length = length(x) )
      # find the first treatment
      y[which(x == 1)[1]] &lt;- 1
      
      
      for (i in seq_along( 1: c(length(y) - max_prot_dur))) {
        
        #Following treatment will be implemented on day 5 if there is 1 in the next five days
        if (y[i] == 1 &amp; sum(x[c(i+1):c(i+5)])&gt;0 ) {y[i+5] &lt;- 1}
        #Or on any following day with risk threshold reached
        if (y[i] == 1 &amp; sum(x[c(i+1):c(i+5)])==0 &amp; x[i+6]==1 ) {y[i+6] &lt;- 1}
        if (y[i] == 1 &amp; sum(x[c(i+1):c(i+6)])==0 &amp; x[i+7]==1 ) {y[i+7] &lt;- 1}
        if (y[i] == 1 &amp; sum(x[c(i+1):c(i+7)])==0 &amp; x[i+8]==1 ) {y[i+8] &lt;- 1}
        if (y[i] == 1 &amp; sum(x[c(i+1):c(i+8)])==0 &amp; x[i+9]==1 ) {y[i+9] &lt;- 1}
        #If warning threshold was not reached at all or 10th day, then spray on 10th day 
        if (y[i] == 1 &amp; sum(x[c(i+1):c(i+9)])==0 ) {y[i+10] &lt;- 1}
        #if there was no treatment 
        if(i== c(length(y) - max_prot_dur)) break
      }
      #Add zeros for the duration of added period
      y[c(length(y) - max_prot_dur) : length(y)] &lt;- 0
      y
    }
    
    trt_df_window &lt;- 
      split(trt_df, trt_df$year_var)
    
    
    for (year in seq_along(trt_df_window)) {
      x &lt;- trt_df_window[[year]]
      trt_df_window[[year]] &lt;- 
        
        lapply(x[grep(&quot;ir&quot;, colnames(x))], function(x)
          TreatmentWindow(x, min_prot_dur,max_prot_dur)) %&gt;%
        bind_cols() %&gt;% 
        rename_all(., .funs = funs(paste0(&quot;w_&quot;, .)))
    }
    
    trt_df_window &lt;-  bind_rows(trt_df_window)

    
    #Combine the data for both scenarios
    trt_df &lt;- bind_cols(trt_df_one, trt_df_window)
    
    
    
    #Calculate number of treatmetns per year
    sum_df &lt;- 
      trt_df %&gt;% 
      group_by(year_var) %&gt;% 
      summarise_at(colnames(trt_df[, grep(&quot;ir&quot;, colnames(trt_df))]), .funs = sum) 
    
    
    
    sum_df$warning_thres &lt;-  warning_threshold
    
    return(sum_df)
  }</code></pre>
<p>Calculate the number of treatments for each warning threshold (EBH).</p>
<pre class="r"><code># this chunk not evaluated
#select max warning threshold
warning_thresholds &lt;- 1:18
begin &lt;- Sys.time()
#Detect the number of cores and set it to total minus 1, if there are multiple cores, to avoid overload
cores &lt;- ifelse(detectCores() &gt; 1, detectCores()-1, 1) 
cl &lt;- makeCluster(cores)
clusterExport(cl, c(&quot;df&quot;, &quot;dates_cut&quot;, &quot;ControlFreqFun&quot;))

clusterEvalQ(cl, library(&quot;tidyverse&quot;, quietly = TRUE, verbose = FALSE))</code></pre>
<pre><code>## [[1]]
##  [1] &quot;forcats&quot;   &quot;stringr&quot;   &quot;dplyr&quot;     &quot;purrr&quot;     &quot;readr&quot;    
##  [6] &quot;tidyr&quot;     &quot;tibble&quot;    &quot;ggplot2&quot;   &quot;tidyverse&quot; &quot;stats&quot;    
## [11] &quot;graphics&quot;  &quot;grDevices&quot; &quot;utils&quot;     &quot;datasets&quot;  &quot;methods&quot;  
## [16] &quot;base&quot;     
## 
## [[2]]
##  [1] &quot;forcats&quot;   &quot;stringr&quot;   &quot;dplyr&quot;     &quot;purrr&quot;     &quot;readr&quot;    
##  [6] &quot;tidyr&quot;     &quot;tibble&quot;    &quot;ggplot2&quot;   &quot;tidyverse&quot; &quot;stats&quot;    
## [11] &quot;graphics&quot;  &quot;grDevices&quot; &quot;utils&quot;     &quot;datasets&quot;  &quot;methods&quot;  
## [16] &quot;base&quot;     
## 
## [[3]]
##  [1] &quot;forcats&quot;   &quot;stringr&quot;   &quot;dplyr&quot;     &quot;purrr&quot;     &quot;readr&quot;    
##  [6] &quot;tidyr&quot;     &quot;tibble&quot;    &quot;ggplot2&quot;   &quot;tidyverse&quot; &quot;stats&quot;    
## [11] &quot;graphics&quot;  &quot;grDevices&quot; &quot;utils&quot;     &quot;datasets&quot;  &quot;methods&quot;  
## [16] &quot;base&quot;</code></pre>
<pre class="r"><code>  control_eval &lt;- pbapply::pblapply(warning_thresholds, function(x)
  {
    xx &lt;-
      ControlFreqFun(x,
      df,
      dates_cut,
      min_prot_dur = 5,
      max_prot_dur = 10)
      return(xx)
  },
  cl = cl
  )
begin- Sys.time() #check the duration of the pcontrol_evaless in the console</code></pre>
<pre><code>## Time difference of -5.327751 secs</code></pre>
<pre class="r"><code>stopCluster(cl)</code></pre>
<p>Melt the data frame.</p>
<pre class="r"><code>control_eval_long &lt;- 
control_eval %&gt;% 
  bind_rows() %&gt;% 
  reshape2::melt(
    id.vars = c(&quot;year_var&quot;, &quot;warning_thres&quot;),
    variable.name = &quot;programme&quot;,
    value.name = &quot;no_of_treatments&quot;
  )
control_eval_long %&gt;% head() %&gt;% pander()</code></pre>
<table style="width:79%;">
<colgroup>
<col width="15%" />
<col width="22%" />
<col width="16%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">year_var</th>
<th align="center">warning_thres</th>
<th align="center">programme</th>
<th align="center">no_of_treatments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">2007</td>
<td align="center">1</td>
<td align="center">ir</td>
<td align="center">14</td>
</tr>
<tr class="even">
<td align="center">2008</td>
<td align="center">1</td>
<td align="center">ir</td>
<td align="center">11</td>
</tr>
<tr class="odd">
<td align="center">2009</td>
<td align="center">1</td>
<td align="center">ir</td>
<td align="center">11</td>
</tr>
<tr class="even">
<td align="center">2010</td>
<td align="center">1</td>
<td align="center">ir</td>
<td align="center">9</td>
</tr>
<tr class="odd">
<td align="center">2011</td>
<td align="center">1</td>
<td align="center">ir</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="center">2012</td>
<td align="center">1</td>
<td align="center">ir</td>
<td align="center">13</td>
</tr>
</tbody>
</table>
<pre class="r"><code>control_eval_long %&gt;% 
# control_eval_long%&gt;% 
  mutate(programme = ifelse(programme== &quot;ir&quot;, &quot;a) Default IR&quot;, 
                            ifelse(programme== &quot;ir_opt&quot;, &quot;b) Optimised IR&quot;,
                                   ifelse(programme == &quot;ir_low_risk&quot;, &quot;c) Low Risk IR&quot;,
                                          ifelse(programme== &quot;w_ir&quot;, &quot;d) Default IR 5-10d&quot;,
                                                 ifelse(programme== &quot;w_ir_opt&quot;, &quot;e) Optimised IR 5-10d&quot;,
                                                        ifelse(programme == &quot;w_ir_low_risk&quot;, &quot;f) Low Risk IR 5-10d&quot;,&quot;&quot;))))))) %&gt;% 
  mutate(programme = factor(
    programme,
    levels = c(
    &quot;a) Default IR&quot;,
    &quot;b) Optimised IR&quot;,
    &quot;c) Low Risk IR&quot;,
    &quot;d) Default IR 5-10d&quot;,
    &quot;e) Optimised IR 5-10d&quot;,
    &quot;f) Low Risk IR 5-10d&quot;
    )
    )) %&gt;%
  mutate(Years = factor(year_var)) %&gt;% 
    ggplot(., aes(factor(warning_thres), no_of_treatments)) +
  geom_vline(xintercept=seq(1,9,1), size = 0.2, color = &quot;gray&quot;, linetype=&quot;dotted&quot;)+
  geom_vline(xintercept=seq(3,9,3), size = 0.2, color = &quot;gray&quot;, linetype=&quot;solid&quot;)+
  # geom_boxplot(width = 0.4, show.legend=FALSE) +
  geom_jitter(aes(color = Years),
              position = position_jitter(width = 0.1),
              # colour = &quot;black&quot;,
              alpha = 0.6,
              size = 1
  ) +
  geom_line(aes(warning_thres, calendar_seven),colour = gray.colors(2)[1])+
  geom_label(aes(14,calendar_seven+0.8 , label= &quot;7-day freq.&quot;), 
             colour = gray.colors(2)[1], fill = NA, label.size = NA, size = 4) +
  geom_line(aes(warning_thres, calendar_five),colour = gray.colors(2)[1])+
  geom_label(aes(14,calendar_five+0.8, label= &quot;5-day freq.&quot;), 
             colour = gray.colors(2)[1], fill = NA, label.size = NA, size = 4) +
  geom_smooth(method = &quot;loess&quot;,
              se = FALSE,
              color = gray.colors(2)[1],
              aes(group = 1)) +
  facet_wrap(~programme, ncol = 3) +
  ggtitle(&quot;Cost effectiveness of model versions&quot;) +
  
  xlab(&quot;Warning thresholds (EBH)&quot;) +
  ylab(&quot;Number of treatments&quot;) +
  scale_x_discrete(breaks=seq(0, 18, 3)) +
  theme(legend.position = &quot;top&quot;)+
  theme_article()</code></pre>
<p><img src="images/plot_models-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>The figure shows how does the frequency of recommended treatments vary with the increasing decision thresholds of the three model versions and how does it differ from the calendar spray programmes. The dots represent the number of treatments in relation to corresponding warning threshold, where each dot represents a single year. If the fitted smoothed line is above the estimated calendar frequency line, the model recommends more treatments than the usual standard calendar programme.</p>
<p>There is variation in the data and it would be interesting to see if there is an effect of year.</p>
<pre class="r"><code>control_eval_long %&gt;% 
# control_eval_long%&gt;% 
  mutate(programme = ifelse(programme== &quot;ir&quot;, &quot;Default IR&quot;, 
                            ifelse(programme== &quot;ir_opt&quot;, &quot;Optimised IR&quot;,
                                   ifelse(programme == &quot;ir_low_risk&quot;, &quot;Low Risk IR&quot;,
                                          ifelse(programme== &quot;w_ir&quot;, &quot;Default IR 5-10d&quot;,
                                                 ifelse(programme== &quot;w_ir_opt&quot;, &quot;Optimised IR 5-10d&quot;,
                                                        ifelse(programme == &quot;w_ir_low_risk&quot;, &quot;Low Risk IR 5-10d&quot;,&quot;&quot;))))))) %&gt;% 
  mutate(programme = factor(
    programme,
    levels = c(
    &quot;Default IR&quot;,
    &quot;Optimised IR&quot;,
    &quot;Low Risk IR&quot;,
    &quot;Default IR 5-10d&quot;,
    &quot;Optimised IR 5-10d&quot;,
    &quot;Low Risk IR 5-10d&quot;
    )
    )) %&gt;%
  mutate(Years = factor(year_var)) %&gt;% 
ggplot(., aes(factor(warning_thres), no_of_treatments, group =programme, colour =programme)) +
  geom_vline(xintercept=seq(1,9,1), size = 0.2, color = &quot;gray&quot;, linetype=&quot;dotted&quot;)+
  geom_vline(xintercept=seq(3,9,3), size = 0.2, color = &quot;gray&quot;, linetype=&quot;solid&quot;)+

  geom_line(aes())+
  geom_line(aes(warning_thres, 12),colour = gray.colors(2)[1])+
  geom_label(aes(14,calendar_seven+0.8 , label= &quot;7-day freq.&quot;), 
             colour = gray.colors(2)[1], fill = NA, label.size = NA, size = 3) +
  geom_line(aes(warning_thres, 17),colour = gray.colors(2)[1])+
  geom_label(aes(14,calendar_five+0.8, label= &quot;5-day freq.&quot;), 
             colour = gray.colors(2)[1], fill = NA, label.size = NA, size = 3) +
  facet_wrap(~Years, ncol = 5)+
  ggtitle(&quot;Treatment Frequency as a Factor the Decision Threshold&quot;) +
  theme(strip.text.y = element_blank())+
  xlab(&quot;Warning thresholds (EBH)&quot;) +
  ylab(&quot;Number of treatments&quot;) +
  theme_article() + 
  geom_vline(xintercept=c(2,3,4), size = 0.5, color = &quot;gray&quot;, linetype=&quot;dotted&quot;)+
  scale_x_discrete(breaks=seq(0, 18, 3))+
  scale_y_continuous(breaks=seq(0, 30, 5))+
  scale_colour_manual( &quot;Model&quot;,values = c(&quot;#a6cee3&quot;, &quot;#1f78b4&quot;, &quot;#7570b3&quot;,&quot;orange&quot;, &quot;red&quot;, &quot;yellow&quot; ))+
  theme(legend.position=&quot;top&quot;,
        text = element_text( size = 11))</code></pre>
<p><img src="images/plot_years-1.png" width="1056" style="display: block; margin: auto;" /></p>
<p>It is evident that setting a threshold to even a minimum accumulation of risk, in other words a single effective blight hour, is triggering less treatments in certain years.</p>
</div>
<div id="dose-reduction-for-calendar-treatment" class="section level1">
<h1>Dose reduction for calendar treatment</h1>
<p>Possible dose reductions are calculated for the usual 7 day calendar treatment.<br />
Calculate the dose reductions based on the model outputs. Dose is reduced to quarters based on the risk output. The maximum dose is applied if the risk is over 12EBH.</p>
<pre class="r"><code>test.overlap = function(vals, start_date, end_date) {
  rowSums(mapply(function(a, b)
    between(vals, a, b),
    start_date, end_date)) &gt; 0
}
#Dose calculation function based on the risk output
Dose &lt;-  function(x){
  ifelse(x &gt;=0 &amp; x &lt;=3, 0,
         ifelse(x &gt;3 &amp; x &lt;=6, 0.25,
                ifelse(x &gt;6 &amp; x &lt;=9, 0.5,
                       ifelse(x &gt;9 &amp; x &lt;=12, 0.75,
                              ifelse(x &gt;12,  1,1
                              )
                       )
                )
         )
  )
}</code></pre>
<p>The function is applied on the data.</p>
<pre class="r"><code>dosedf &lt;- 
  df %&gt;% 
  filter(test.overlap(short_date, 
                      dates_cut$prot_start, 
                      dates_cut$season_end 
                      )
  ) %&gt;%
  dplyr::select(
    ends_with(&quot;year_var&quot;),
    ends_with(&quot;week_var&quot;),
    ends_with(&quot;doy&quot;),
    starts_with(&quot;ir&quot;)
  ) %&gt;%
  group_by(year_var, week_var, doy) %&gt;%
  summarise_at(., .vars = colnames(.[grep(&quot;ir&quot;, colnames(.))]), .funs = max) %&gt;%   #get max daily values
  group_by(year_var) %&gt;% 
  mutate( treat_week = sort(rep(seq(1, 19, 1),7))[1:n()] ) %&gt;% 
  group_by(year_var, treat_week) %&gt;% 
  summarise_at(., .vars = colnames(.[grep(&quot;ir&quot;, colnames(.))]), .funs = max) %&gt;% 
  mutate_at(., 
            .vars = colnames(.[grep(&quot;ir&quot;, colnames(.))]), 
            .funs = Dose)</code></pre>
<pre class="r"><code>#Get number of treatments per year and the dose reduction
Summary &lt;- function(x) {
  data.frame(
    n = length(x),
    treatments = sum(as.numeric(x!=0)),
    dose = sum(x)/length(x)
  )
}

dosedf %&gt;% 
  dplyr::select(-(&quot;treat_week&quot;)) %&gt;% 
  reshape2::melt(id = &quot;year_var&quot;, variable.name = &quot;model&quot;, value.name = &quot;dose&quot;) %&gt;% 
  mutate(model = ifelse(model== &quot;ir&quot;, &quot;Default IR&quot;, 
                            ifelse(model== &quot;ir_opt&quot;, &quot;Optimised IR&quot;,
                                   ifelse(model == &quot;ir_low_risk&quot;, &quot;Low Risk IR&quot;,&quot;&quot;)))) %&gt;%
  mutate(model = factor(model, levels = c(&quot;Default IR&quot;, &quot;Optimised IR&quot;, &quot;Low Risk IR&quot;))) %&gt;% 
  group_by( year_var,model) %&gt;% 
  do(Summary(.$dose)) %&gt;% 
  ggplot(aes(x = year_var, y = dose, fill = model, group = model))+
  geom_bar(color = &quot;black&quot;,stat=&quot;identity&quot;,position=position_dodge(), width = 0.9)+
  geom_text(aes(label=treatments), vjust=-0.3, color=&quot;black&quot;,
            position = position_dodge(0.9), size=2.7)+
  scale_fill_manual(&quot;Model&quot;, values = c(&quot;#f0f0f0&quot;, &quot;#bdbdbd&quot;, &quot;#636363&quot;)) +
  theme_bw()+
  facet_grid(~year_var, scales = &quot;free&quot;)+
  scale_y_continuous(limits = c(0,1))+
  labs(x = &quot;Year&quot;, 
       y = &quot;Dose Reduction\n&quot;)+
  theme( axis.title = element_text(size = 11),
         panel.grid.major = element_blank(), 
         panel.grid.minor = element_blank(),
         axis.text = element_text(size = 11),
         legend.position = &quot;top&quot;,
         axis.text.x=element_blank(),
         axis.ticks.x=element_blank()
         )</code></pre>
<p><img src="images/unnamed-chunk-9-1.png" width="672" /></p>
<p>Now let us make some summaries to see if we can reduce the number of treatments and fungicide usage based on the model outputs.</p>
<pre class="r"><code>SummaryTwo &lt;- function(x) {
  data.frame(
    n = length(x),
    min = min(x),
    median = as.numeric(median(x)),
    mean = mean(x),
    sd = sd(x),
    max = max(x)
  )
}

dosedf %&gt;% 
  dplyr::select(-(&quot;treat_week&quot;)) %&gt;% 
  reshape2::melt(id = &quot;year_var&quot;, variable.name = &quot;model&quot;, value.name = &quot;dose&quot;) %&gt;% 
  mutate(model = ifelse(model== &quot;ir&quot;, &quot;Default IR&quot;, 
                            ifelse(model== &quot;ir_opt&quot;, &quot;Optimised IR&quot;,
                                   ifelse(model == &quot;ir_low_risk&quot;, &quot;Low Risk IR&quot;,&quot;&quot;)))) %&gt;%    
  mutate(model = factor(model, levels = c(&quot;Default IR&quot;, &quot;Optimised IR&quot;, &quot;Low Risk IR&quot;))) %&gt;% 
  group_by( year_var,model) %&gt;% 
  do(Summary(.$dose)) %&gt;% 
  dplyr::select(-c( &quot;n&quot;, &quot;treatments&quot;)) %&gt;% 
  group_by(model) %&gt;% 
  do(., SummaryTwo(.$dose)) %&gt;% 
  ggplot(aes(x = model, y = mean, fill = model, group = model))+
  geom_bar(color = &quot;black&quot;,stat=&quot;identity&quot;,position=position_dodge(), width = 0.7)+
  geom_errorbar(aes(ymin = mean - sd, 
                    ymax = mean + sd), width = 0.2) +
  scale_fill_manual(&quot;Model&quot;, values = c(&quot;#f0f0f0&quot;, &quot;#bdbdbd&quot;, &quot;#636363&quot;)) +
  theme_bw()+
  scale_y_continuous(limits = c(0,1),breaks = seq(0,1,0.2))+
  labs(x = &quot;Model&quot;, 
       y = &quot;Dose Reduction\n&quot;)+
  theme( axis.title = element_text(size = 11),
         panel.grid.major = element_blank(), 
         panel.grid.minor = element_blank(),
         axis.text = element_text(size = 11),
         legend.position = c(0.35, 0.85),
         axis.text.x=element_blank(),
        axis.ticks.x=element_blank()
  )  +
  coord_equal(6/1)</code></pre>
<p><img src="images/unnamed-chunk-10-1.png" width="672" /></p>
<p>Packages used</p>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 3.5.1 (2018-07-02)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 17134)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United States.1252 
## [2] LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252
## [4] LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
##  [1] gt_0.1.0          pander_0.6.3      here_0.1         
##  [4] mgsub_1.5.0       rcompanion_2.0.10 R.utils_2.7.0    
##  [7] R.oo_1.22.0       R.methodsS3_1.7.1 GGally_1.4.0     
## [10] rsm_2.10          egg_0.4.2         gridExtra_2.3    
## [13] ggthemes_4.0.1    ggrepel_0.8.0     pbapply_1.3-4    
## [16] remotes_2.0.2     pracma_2.2.2      devtools_1.13.6  
## [19] padr_0.4.1        knitr_1.22        lubridate_1.7.4  
## [22] data.table_1.11.8 readxl_1.2.0      forcats_0.3.0    
## [25] stringr_1.4.0     dplyr_0.8.0.1     purrr_0.2.5      
## [28] readr_1.3.1       tidyr_0.8.2       tibble_2.0.1     
## [31] ggplot2_3.1.0     tidyverse_1.2.1  
## 
## loaded via a namespace (and not attached):
##  [1] nlme_3.1-137       RColorBrewer_1.1-2 httr_1.4.0        
##  [4] rprojroot_1.3-2    tools_3.5.1        backports_1.1.3   
##  [7] R6_2.3.0           nortest_1.0-4      lazyeval_0.2.1    
## [10] colorspace_1.3-2   withr_2.1.2        tidyselect_0.2.5  
## [13] emmeans_1.3.1      compiler_3.5.1     cli_1.0.1         
## [16] rvest_0.3.2        expm_0.999-3       xml2_1.2.0        
## [19] sandwich_2.5-0     labeling_0.3       sass_0.1.0.9000   
## [22] checkmate_1.8.5    scales_1.0.0       lmtest_0.9-36     
## [25] mvtnorm_1.0-8      multcompView_0.1-7 commonmark_1.7    
## [28] digest_0.6.18      foreign_0.8-70     rmarkdown_1.12.6  
## [31] pkgconfig_2.0.2    htmltools_0.3.6    manipulate_1.0.1  
## [34] highr_0.7          rlang_0.3.1        rstudioapi_0.8    
## [37] generics_0.0.2     zoo_1.8-4          jsonlite_1.6      
## [40] magrittr_1.5       modeltools_0.2-22  Matrix_1.2-14     
## [43] Rcpp_1.0.0         DescTools_0.99.26  munsell_0.5.0     
## [46] stringi_1.2.4      multcomp_1.4-8     yaml_2.2.0        
## [49] MASS_7.3-50        plyr_1.8.4         grid_3.5.1        
## [52] crayon_1.3.4       lattice_0.20-35    haven_2.0.0       
## [55] splines_3.5.1      hms_0.4.2          pillar_1.3.1      
## [58] EMT_1.1            boot_1.3-20        estimability_1.3  
## [61] reshape2_1.4.3     codetools_0.2-15   stats4_3.5.1      
## [64] glue_1.3.0         evaluate_0.13      modelr_0.1.2      
## [67] cellranger_1.1.0   gtable_0.2.0       reshape_0.8.8     
## [70] assertthat_0.2.0   xfun_0.6           coin_1.2-2        
## [73] xtable_1.8-3       broom_0.5.1        coda_0.19-2       
## [76] survival_2.42-3    memoise_1.1.0      TH.data_1.0-9</code></pre>
</div>



Copyright 2018 Mladen Čučak


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
